\documentclass{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{remark}[theorem]{Remark}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\begin{document}

\section{Introduction}
\section{Preliminaries}
First we must clarify a few frequently used definitions and results.

\begin{definition}
    We call a set $S$ a \textit{semigroup} if it has an associative binary operation
    that sends a pair of elements $(a, b) \mapsto ab$ for all $a, b \in S$.
\end{definition}

\begin{definition}
    We call a semigroup $S$ an \textit{inverse semigroup} if for every $s \in S$, there exists a unique
    element $s^* \in S$ such that $s = ss^*s$ and $s^* = s^*ss^*$. We call $s^*$ the \textit{inverse} of $s$.
\end{definition}

\begin{definition}
    An element $e$ of an inverse semigroup $S$ is called an \textit{idempotent} if
    $e = e^2$. Note that for all idempotents, $e = e^*$, and for all elements $s$ in
    an inverse semigroup, $ss^*$ and $s^*s$ are idempotent. We denote the set of idempotents
    on $S$ by $E(S)$.
\end{definition}

\begin{remark}
    If $S$ is an inverse semigroup, for $e$, $f \in E(S)$, $ef = fe$.
\end{remark}
In other words, the idempotents of an inverse semigroup commute. A proof of this can be found in Kyle's paper. cite this properly

\begin{definition}
    Let $S$ be a set. A relation $\leq$ on $S$ is called a \textit{partial order} if,
    \begin{itemize}
        \item It is reflexive; $a \leq a \quad \forall a \in S$.
        \item It is antisymmetric; $a \leq b$ and $b \leq a \implies a = b \quad \forall a, b \in S$.
        \item It is transitive; $a \leq b$ and $b \leq c \implies a \leq c \quad \forall a, b, c \in S$.
    \end{itemize}
    A set $S$ paired with a \textit{partial order} is called a partially ordered set, or a \textit{poset}.
\end{definition}

\section{Filters}
\section{Directed Graphs}
\section{References}

\begin{lemma} If $(\alpha, \alpha)(\beta, \beta) \neq 0$ and $|\alpha| = |\beta|$, then $\alpha = \beta$. \end{lemma}
\begin{proof}
    Without loss of generality, suppose $\alpha$ is a prefix of $\beta$. Then $\alpha = \beta \beta'$ for some $\beta$. But
    $|\alpha| = |\beta|$, so $|\beta'| = 0$, meaning $\beta' = s(\beta)$. Thus $\alpha = \beta s(\beta) = \beta$.
\end{proof}
An immediate consequence of this is that for any given length, a filter contains at most one element corresponding
to a path of that length. Furthermore, if $\zeta$ is a filter, and $(\alpha, \alpha) \in \zeta$ such that $|\alpha| = n$,
we can restrict $\alpha$ to any length $0 \leq m < n$ to produce a unique element of length $m$ inside $\zeta$.

\begin{theorem} $\hat{E}_0 = \{\xi_\alpha$: $\alpha \in E^*\} \cup \{\eta_x$: $x \in E^\infty\}$ \end{theorem}
\begin{proof}
    First we show that $\xi_\alpha$ and $\eta_x$ are filters. Let $\alpha$ be a finite path and let $x$ be an infinite path.
    Consider $(\beta, \beta), \ (\gamma, \gamma) \in \xi_\alpha$ with $|\beta| = m$, $|\gamma| = n$. 
    Reading edges left to right, $\beta$ contains the first $m$ edges of $\alpha$ and $\gamma$ 
    contains the first $n$ edges of $\alpha$. Without loss of generality, assume $m \leq n$. 
    We can extend $\beta$ by the next $n - m$ edges of $\alpha$ to produce $\gamma$. Thus
    $\beta$ is a prefix of $\gamma$, so $(\beta, \beta)(\gamma, \gamma) = (\gamma, \gamma) \in \xi_\alpha$.
    A similar argument shows that $\eta_x$ is closed under multiplication. So both $\xi_\alpha$ and $\eta_x$ are prefilters
    on $E(S(E))$. Next, let $(\beta, \beta) \in \xi_\alpha$, and let $(\delta, \delta) \in E(S(E))$ so that 
    $(\beta, \beta) \leq (\delta, \delta)$. Then $\beta = \delta \delta'$ for some $\delta' \in E^*$. 
    Thus $\alpha = \beta \beta' = \delta \delta' \beta'$. Therefore $\delta$ is a prefix of $\alpha$, so 
    $(\delta, \delta) \in \xi_\alpha$. Like before, a very similar argument works for $\eta_x$. So both 
    $\xi_\alpha$ and $\eta_x$ are filters. Going the other way, take a filter $\zeta \in \hat{E}_0$.
    We do this in cases.
    \\ \\
    \textit{Case $1$. $\zeta$ is finite.}
    Let $(\alpha, \alpha)$ be the minimum element inside $\zeta$. Since $\zeta$ is a filter,
    For $(\beta, \beta) \in E(S(E))$, $(\alpha, \alpha) \leq (\beta, \beta) \implies (\beta, \beta) \in \zeta$.
    However, by the definition of the minimal element, $(\beta, \beta) \in \zeta \implies (\alpha, \alpha) \leq (\beta, \beta)$.
    Thus $(\beta, \beta) \in \zeta$ if and only if $(\alpha, \alpha) \leq (\beta, \beta) \iff \beta$ is a prefix of $\alpha$. So $\zeta = \xi_\alpha$.
    \\ \\
    \textit{Case $2$. $\zeta$ is infinite.}
    By the lemma above, we can get an idea of what elements of $\zeta$ look like.
    For each nonnegative integer, $\zeta$ contains precisely one element corresponding
    to a path of that length. Because we require nonzero product between elements, every
    path in the filter is a prefix of every longer path also contained inside the filter.
    All of this given, we can find an $x \in E^\infty$ such that every path inside $\zeta$
    is a prefix of $x$. By the uniqueness of filter elements, it follows that $\zeta = \eta_x$.
    \\ \\
    We have shown that a nonempty subset $\zeta \subset E(S(E))$ is a filter if and only if
    it is of the form $\xi_\alpha$ or $\eta_x$. Thus $\hat{E}_0 = \{\xi_\alpha$: $\alpha \in E^*\} \cup \{\eta_x$: $x \in E^\infty\}$.
\end{proof}
Now that we know what filters look like on the graph inverse semigroup, the task of identifying ultrafilters becomes much simpler.

\begin{theorem} $\hat{E}_\infty = \{\eta_x$: $x \in E^\infty\} \cup \{\xi_\alpha$: $\alpha \in E^*$ and $|r^{-1}\{s(\alpha)\}| = 0 \}$ \end{theorem}
\begin{proof}
    We need only consider various kinds of filters, determining whether they are ultrafilters or not. We do this in cases.
    \\ \\
    \textit{Case $1$. $\xi_\alpha$, $|r^{-1}\{s(\alpha)\}| > 0$.} Take $e \in E^1$ such that $r(e) = s(\alpha)$. It is clear that
    $\xi_\alpha \subset \xi_{\alpha e}$. So $\xi_\alpha$ is not an ultrafilter.
    \\ \\
    \textit{Case $2$. $\xi_\alpha$, $|r^{-1}\{s(\alpha)\}| = 0$.} Suppose we can find $\zeta \in \hat{E}_0$ such that $\xi_\alpha \subset \zeta$.
    For $0 \leq i \leq |\alpha|$, $\zeta$ inherits its idempotent with the path corresponding to length $i$ from $\xi_\alpha$. So we can find an element $(\beta, \beta) \in \zeta$ with
    $|\beta| > |\alpha|$ and $(\alpha, \alpha)(\beta, \beta) \neq 0$. Thus $\beta = \alpha \alpha'$ for some $\alpha' \in E^*$. But no edges go to $s(\alpha)$, so we cannot
    construct $\alpha'$ with $r(\alpha') = s(\alpha)$. This is a contradiction, so $\xi_\alpha$ is an ultrafilter.
    \\ \\
    \textit{Case $3$. $\eta_x$, $x \in E^\infty$.} Suppose there exists $\zeta \in \hat{E}_0$ such that $\eta_x \subset \zeta$. Then we can find
    $(\beta, \beta) \in \zeta$ such that $(\beta, \beta) \notin \eta_x$. But $\eta_x$, as we showed before, contains an element $z$ corresponding to
    a path of length $|\beta|$. As a superset of $\eta_x$, $\zeta$ also contains $z$. By the lemma at the start, it follows that $(\beta, \beta) = z \in \eta_x$,
    which is a contradiction. So $\eta_x$ is an ultrafilter for all $x \in E^\infty$.
    \\ \\
    We have identified which filters are ultrafilters, showing that $\hat{E}_\infty = \{\xi_\alpha$: $\alpha \in E^*$ and $|r^{-1}\{s(\alpha)\}| = 0\} \cup \{\eta_x$: $x \in E^\infty\}$.
\end{proof}

\begin{theorem} Let $E$ be a directed graph, and $\alpha \in E^*$ such that $|r^{-1}\{s(\alpha)\}| = \infty$.
    Let $X, Y \subseteq_{\text{fin}} E(S(E))$, and $Z$ be a finite cover of $E^{X, Y}$.
If $\xi_\alpha \in \mathcal{U}(X, Y)$, then $\xi_\alpha \cap Z \neq \emptyset$. \end{theorem}
\begin{proof}
    First note:
    \begin{align*}
        E^{X, Y} &= \{ e \in E(S(E))\text{: } e \leq x \ \forall x \in x \text{ and } ey = 0 \ \forall y \in Y \} \\
                 &= \{ e \in E(S(E))\text{: } e \leq \text{min}(X) \text{ and } ey = 0 \ \forall y \in Y \} \\
                 &= E^{\{\text{min}(X)\}, Y}
    \end{align*}
    Letting min$(X) = (x, x)$,
    \begin{align*}
        E^{X, Y} = \{ (xx', xx') \text{: } x' \in E^*, \ r(x') = s(x) \text{ and } (xx', xx')y = 0 \ \forall y \in Y \}
    \end{align*}

    Consider the set $C := \{ (\alpha b, \alpha b)\text{: } b \in E^1, \ s(\alpha) = r(b) \}$. By the assumption
    that $s(\alpha)$ is an infinite receiver, $C$ is infinite. Given $y \in Y$, let $\nu$ be the path corresponding to $y$.
    Since $\xi_\alpha \in \mathcal{U}(X, Y)$, $\nu$ is not a prefix of $\alpha$, and thus not a proper prefix of $\alpha b$ 
    for any $b$. Thus, if $(\alpha b, \alpha b)y \neq 0$, $\alpha b$ is a prefix of $\nu$. Then for $\beta \neq b$, 
    $\alpha \beta$ cannot be a prefix of $\nu$. So there is at most one element of $C$ such that ($\alpha b, \alpha b)y \neq 0$.
    By the assumption that $Y$ is finite, all but finitely many elements of $C$ are inside $E^{\{(x, x)\}, Y}$. Therefore, if $Z$
    is a cover of $E^{X, Y}$, $Z$ is an outer cover of the infinite set $E^{X, Y} \cap C$. Because $Z$ is finite, $\exists z \in Z$ 
    with $(\alpha b, \alpha b)z \neq 0$ for infinitely many $(\alpha b, \alpha b) \in E^{X, Y} \cap C$. If $\upsilon$ is the path corresponding to $z$,
    then for every $b$, either $\upsilon$ is a prefix of $\alpha b$, or $\alpha b$ is a prefix of $\upsilon$.
    All the $\alpha b$ are the same length with a different starting edge, so if one is a prefix of $\upsilon$,
    no other can be a prefix of $\upsilon$. So $\upsilon$ is a prefix of $\alpha b$ for infinitely many $b$. Thus $|\upsilon| \leq |\alpha| + 1$.
    If $|\upsilon| = |\alpha| + 1$, we have a contradiction: $b = \beta$ for all $(\alpha b, \alpha b), (\alpha \beta, \alpha, \beta) \in C$.
    Thus $|\upsilon| \leq |\alpha|$, so $\upsilon$ is a prefix of $\alpha$. Therefore $z = (\upsilon, \upsilon) \in \xi_\alpha$, so 
    $\xi_\alpha \cap Z \neq \emptyset$.
\end{proof}

\end{document}
